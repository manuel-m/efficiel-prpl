var app=function(n){"use strict";function e(n,t,l){var r=typeof t;if(l===t);else if("string"===r)l=n.innerText=t;else if("number"===r||"boolean"===r)t=t.toString(),l=n.innerText=t;else if(null==t)h(n),l="";else if("function"===r)v(function(){l=e(n,t(),l)});else if(t instanceof Node)Array.isArray(l)?0===l.length?n.appendChild(t):1===l.length?n.replaceChild(t,l[0]):(h(n),n.appendChild(t)):""===l?n.appendChild(t):n.replaceChild(t,n.firstChild),l=t;else{if(!Array.isArray(t))throw new Error("content must be Node, stringable, or array of same");var o=d([],t);0===o.length?h(n):Array.isArray(l)?0===l.length?c(n,o,0,o.length):s(n,l,o):""===l?c(n,o,0,o.length):s(n,[n.firstChild],o),l=o}return l}var t=-1,l=-2,r=0,o=16,u=1<<o,i=u-1;function s(n,e,s){var c,d,g,v=s.length,w=0,m=e.length-1,y=0,C=v-1,b=e[w],A=s[y],_=e[m],x=s[C],N=_.nextSibling,k=!0;n:for(;k;){for(k=!1;a(A,b,y,s);){if(w++,++y>C||w>m)break n;A=s[y],b=e[w]}for(;a(x,_,C,s);){if(N=_,m--,y>--C||w>m)break n;x=s[C],_=e[m]}for(;a(A,_,y,s);){if(k=!0,n.insertBefore(_,b),m--,++y>C||w>m)break n;A=s[y],_=e[m]}for(;a(x,b,C,s);){if(k=!0,null===N?n.appendChild(b):n.insertBefore(b,N),N=b,w++,y>--C||w>m)break n;x=s[C],b=e[w]}}if(y>C)for(;w<=m;)n.removeChild(e[m]),m--;else if(w>m)for(;y<=C;)f(n,s[y],N,y,s),y++;else{var E=[];for(c=w,d=(w<<o)+(r=(r+1)%u);c<=m;c++,d+=u)void 0===(b=e[c]).__surplus_order?Object.defineProperty(b,"__surplus_order",{value:d,writable:!0}):b.__surplus_order=d,b instanceof Text&&E.push(c);var T=new Array(C-y+1),B=[],S=0;for(c=y;c<=C;c++)"string"==typeof(A=s[c])?(B.push(c),T[c-y]=t):void 0!==(d=A.__surplus_order)&&(d&i)===r?(d>>=o,T[c-y]=d,e[d]=null,S++):T[c-y]=t;if(0!==S||0!==w||m!==e.length-1){var j=function(n){for(var e=[],t=[],l=-1,r=new Array(n.length),o=0,u=n.length;o<u;o++){var i=n[o];if(!(i<0)){var s=p(e,i);-1!==s&&(r[o]=t[s]),s===l?(e[++l]=i,t[l]=o):i<e[s+1]&&(e[s+1]=i,t[s+1]=o)}}for(o=t[l];l>=0;o=r[o],l--)e[l]=o;return e}(T);for(c=0;c<j.length;c++)T[j[c]]=l;var O=0,P=0,q=0;for(c=0,d=0,g=0;c<B.length;c++){for(O=B[c];d<j.length&&(P=j[d])<O-y;)d++;for(;g<E.length&&(q=E[g],0!==d)&&q<T[j[d-1]];)g++;g<E.length&&(d===j.length||q<T[P])?(b=e[q],A=s[O],b.data!==A&&(b.data=A),e[q]=null,s[O]=b,T[O]=l,g++):s[O]=document.createTextNode(s[O])}for(;w<=m;)null!==(b=e[w])&&n.removeChild(b),w++;for(;y<=C;)x=s[C],T[C-y]!==l&&(null===N?n.appendChild(x):n.insertBefore(x,N)),N=x,C--}else for(h(n);y<=C;)f(n,s[y],null,y,s),y++}}function a(n,e,t,l){return n===e||"string"==typeof n&&e instanceof Text&&(e.data!==n&&(e.data=n),l[t]=e,!0)}function c(n,e,t,l){for(var r;t<l;t++)(r=e[t])instanceof Node?n.appendChild(r):(r=e[t]=document.createTextNode(r),n.appendChild(r))}function f(n,e,t,l,r){"string"==typeof e&&(e=r[l]=document.createTextNode(e)),null===t?n.appendChild(e):n.insertBefore(e,t)}function d(n,e){for(var t=0,l=e.length;t<l;t++){var r=e[t];r instanceof Node?n.push(r):null==r||(Array.isArray(r)?d(n,r):"string"==typeof r?n.push(r):n.push(r.toString()))}return n}function h(n){n.textContent=""}function p(n,e){var t=-1,l=n.length;if(l>0&&n[l-1]<=e)return l-1;for(;l-t>1;){var r=Math.floor((t+l)/2);n[r]>e?l=r:t=r}return t}function g(n,e,t){var l=document.createElement(n);return e&&(l.className=e),t&&t.appendChild(l),l}var v=function(n,e){var t=B,l=T;null===t&&console.warn("computations created without a root or parent will never be disposed");var r=new y(n,e);return B=T=r,null===E?function(n){E=k,k.changes.reset(),k.updates.reset();try{n.value=n.fn(n.value),(k.changes.count>0||k.updates.count>0)&&(k.time++,P(k))}finally{E=B=T=null}}(r):r.value=r.fn(r.value),t&&t!==S&&(null===t.owned?t.owned=[r]:t.owned.push(r)),B=t,T=l,function(){if(null!==T){if(r.age===k.time){if(r.state===N)throw new Error("circular dependency");M(r)}!function(n,e){null===n.log&&(n.log=new C);j(n.log,e)}(r,T)}return r.value}};Object.defineProperty(v,"default",{value:v}),v.root=function(n){var e=B,t=0===n.length?S:new y(null,null),l=void 0,r=0===n.length?null:function(){null!==E?k.disposes.add(t):G(t)};return B=t,null===E?l=function(n,e,t){try{return null===e?n():n(e)}finally{B=t}}(n,r,e):(l=null===r?n():n(r),B=e),l};v.on=function(n,e,t,l){Array.isArray(n)&&(r=n,n=function(){for(var n=0;n<r.length;n++)r[n]()});var r;return l=!!l,v(o,t);function o(t){var r=T;return n(),l?l=!1:(T=null,t=e(t),T=r),t}};v.data=function(n){var e=new m(n);return function(n){if(arguments.length>0){if(null!==E)if(e.pending!==A){if(n!==e.pending)throw new Error("conflicting changes: "+n+" !== "+e.pending)}else e.pending=n,k.changes.add(e);else null!==e.log?(e.pending=n,k.changes.add(e),O()):e.value=n;return n}return null!==T&&function(n,e){null===n.log&&(n.log=new C);j(n.log,e)}(e,T),e.value}},v.value=function(n,e){var t=v.data(n),l=-1;return function(r){if(0===arguments.length)return t();if(!(e?e(n,r):n===r)){var o=k.time;if(l===o)throw new Error("conflicting values: "+r+" is not the same as "+n);l=o,n=r,t(r)}return r}},v.freeze=function(n){var e=void 0;if(null!==E)e=n();else{(E=k).changes.reset();try{e=n(),O()}finally{E=null}}return e},v.sample=function(n){var e,t=T;return null!==t?(T=null,e=n(),T=t):e=n(),e},v.cleanup=function(n){null!==B?null===B.cleanups?B.cleanups=[n]:B.cleanups.push(n):console.warn("cleanups created without a root or parent will never be run")};var w=function(){return function(){this.time=0,this.changes=new b,this.updates=new b,this.disposes=new b}}(),m=function(){return function(n){this.value=n,this.pending=A,this.log=null}}(),y=function(){return function(n,e){this.fn=n,this.value=e,this.state=_,this.source1=null,this.source1slot=0,this.sources=null,this.sourceslots=null,this.log=null,this.owned=null,this.cleanups=null,this.age=k.time}}(),C=function(){return function(){this.node1=null,this.node1slot=0,this.nodes=null,this.nodeslots=null}}(),b=function(){function n(){this.items=[],this.count=0}return n.prototype.reset=function(){this.count=0},n.prototype.add=function(n){this.items[this.count++]=n},n.prototype.run=function(n){for(var e=this.items,t=0;t<this.count;t++)n(e[t]),e[t]=null;this.count=0},n}(),A={},_=0,x=1,N=2,k=new w,E=null,T=null,B=null,S=new y(null,null);function j(n,e){var t,l=null===e.source1?-1:null===e.sources?0:e.sources.length;null===n.node1?(n.node1=e,n.node1slot=l,t=-1):null===n.nodes?(n.nodes=[e],n.nodeslots=[l],t=0):(t=n.nodes.length,n.nodes.push(e),n.nodeslots.push(l)),null===e.source1?(e.source1=n,e.source1slot=t):null===e.sources?(e.sources=[n],e.sourceslots=[t]):(e.sources.push(n),e.sourceslots.push(t))}function O(){var n=B;k.updates.reset(),k.time++;try{P(k)}finally{E=T=null,B=n}}function P(n){var e=E,t=0;for(E=n,n.disposes.reset();0!==n.changes.count||0!==n.updates.count||0!==n.disposes.count;)if(t>0&&n.time++,n.changes.run(q),n.updates.run(M),n.disposes.run(G),t++>1e5)throw new Error("Runaway clock detected");E=e}function q(n){n.value=n.pending,n.pending=A,n.log&&z(n.log)}function z(n){var e=n.node1,t=n.nodes;if(null!==e&&F(e),null!==t)for(var l=0,r=t.length;l<r;l++)F(t[l])}function F(n){var e=k.time;n.age<e&&(n.age=e,n.state=x,k.updates.add(n),null!==n.owned&&I(n.owned),null!==n.log&&z(n.log))}function I(n){for(var e=0;e<n.length;e++){var t=n[e];t.age=k.time,t.state=_,null!==t.owned&&I(t.owned)}}function M(n){if(n.state===x){var e=B,t=T;B=T=n,n.state=N,R(n,!1),n.value=n.fn(n.value),n.state=_,B=e,T=t}}function R(n,e){var t,l,r=n.source1,o=n.sources,u=n.sourceslots,i=n.cleanups,s=n.owned;if(null!==i){for(t=0;t<i.length;t++)i[t](e);n.cleanups=null}if(null!==s){for(t=0;t<s.length;t++)G(s[t]);n.owned=null}if(null!==r&&(D(r,n.source1slot),n.source1=null),null!==o)for(t=0,l=o.length;t<l;t++)D(o.pop(),u.pop())}function D(n,e){var t,l,r=n.nodes,o=n.nodeslots;-1===e?n.node1=null:(t=r.pop(),l=o.pop(),e!==r.length&&(r[e]=t,o[e]=l,-1===l?t.source1slot=e:t.sourceslots[l]=e))}function G(n){n.fn=null,n.log=null,R(n,!0)}var H={clic:0,route:"/",message:v.data("Click me"),views:{}};function J(){H.clic+=1,H.message("Click me ["+H.clic+"]")}var K={home:function(){return function(){var n,t,l;return n=g("div",null,null),(t=g("h1",null,n)).onclick=J,l=g("ul",null,n),v(function(n){return e(t,H.message(),n)},""),v(function(n){return e(l,["a","b"].map(function(n){return function(){var t;return e(t=g("li",null,null),n,""),t}()}),n)},""),n}()}},L=document.getElementById("app"),Q=K.home();return window.requestAnimationFrame(function(){L.parentNode.replaceChild(Q,L),L=void 0}),n.model={},n.routes=K,n.vm=H,n}({});
