!function(){"use strict";var n=function(n,e){var t=h,o=d;null===t&&console.warn("computations created without a root or parent will never be disposed");var s=new l(n,e);return h=d=s,null===f?function(n){f=a,a.changes.reset(),a.updates.reset();try{n.value=n.fn(n.value),(a.changes.count>0||a.updates.count>0)&&(a.time++,w(a))}finally{f=h=d=null}}(s):s.value=s.fn(s.value),t&&t!==p&&(null===t.owned?t.owned=[s]:t.owned.push(s)),h=t,d=o,function(){if(null!==d){if(s.age===a.time){if(s.state===c)throw new Error("circular dependency");S(s)}!function(n,e){null===n.log&&(n.log=new u);g(n.log,e)}(s,d)}return s.value}};Object.defineProperty(n,"default",{value:n}),n.root=function(n){var e=h,t=0===n.length?p:new l(null,null),u=void 0,o=0===n.length?null:function(){null!==f?a.disposes.add(t):j(t)};return h=t,null===f?u=function(n,e,t){try{return null===e?n():n(e)}finally{h=t}}(n,o,e):(u=null===o?n():n(o),h=e),u};n.on=function(e,t,l,u){Array.isArray(e)&&(o=e,e=function(){for(var n=0;n<o.length;n++)o[n]()});var o;return u=!!u,n(s,l);function s(n){var l=d;return e(),u?u=!1:(d=null,n=t(n),d=l),n}};n.data=function(n){var e=new t(n);return function(n){if(arguments.length>0){if(null!==f)if(e.pending!==s){if(n!==e.pending)throw new Error("conflicting changes: "+n+" !== "+e.pending)}else e.pending=n,a.changes.add(e);else null!==e.log?(e.pending=n,a.changes.add(e),v()):e.value=n;return n}return null!==d&&function(n,e){null===n.log&&(n.log=new u);g(n.log,e)}(e,d),e.value}},n.value=function(e,t){var l=n.data(e),u=-1;return function(n){if(0===arguments.length)return l();if(!(t?t(e,n):e===n)){var o=a.time;if(u===o)throw new Error("conflicting values: "+n+" is not the same as "+e);u=o,e=n,l(n)}return n}},n.freeze=function(n){var e=void 0;if(null!==f)e=n();else{(f=a).changes.reset();try{e=n(),v()}finally{f=null}}return e},n.sample=function(n){var e,t=d;return null!==t?(d=null,e=n(),d=t):e=n(),e},n.cleanup=function(n){null!==h?null===h.cleanups?h.cleanups=[n]:h.cleanups.push(n):console.warn("cleanups created without a root or parent will never be run")};var e=function(){return function(){this.time=0,this.changes=new o,this.updates=new o,this.disposes=new o}}(),t=function(){return function(n){this.value=n,this.pending=s,this.log=null}}(),l=function(){return function(n,e){this.fn=n,this.value=e,this.state=r,this.source1=null,this.source1slot=0,this.sources=null,this.sourceslots=null,this.log=null,this.owned=null,this.cleanups=null,this.age=a.time}}(),u=function(){return function(){this.node1=null,this.node1slot=0,this.nodes=null,this.nodeslots=null}}(),o=function(){function n(){this.items=[],this.count=0}return n.prototype.reset=function(){this.count=0},n.prototype.add=function(n){this.items[this.count++]=n},n.prototype.run=function(n){for(var e=this.items,t=0;t<this.count;t++)n(e[t]),e[t]=null;this.count=0},n}(),s={},r=0,i=1,c=2,a=new e,f=null,d=null,h=null,p=new l(null,null);function g(n,e){var t,l=null===e.source1?-1:null===e.sources?0:e.sources.length;null===n.node1?(n.node1=e,n.node1slot=l,t=-1):null===n.nodes?(n.nodes=[e],n.nodeslots=[l],t=0):(t=n.nodes.length,n.nodes.push(e),n.nodeslots.push(l)),null===e.source1?(e.source1=n,e.source1slot=t):null===e.sources?(e.sources=[n],e.sourceslots=[t]):(e.sources.push(n),e.sourceslots.push(t))}function v(){var n=h;a.updates.reset(),a.time++;try{w(a)}finally{f=d=null,h=n}}function w(n){var e=f,t=0;for(f=n,n.disposes.reset();0!==n.changes.count||0!==n.updates.count||0!==n.disposes.count;)if(t>0&&n.time++,n.changes.run(m),n.updates.run(S),n.disposes.run(j),t++>1e5)throw new Error("Runaway clock detected");f=e}function m(n){n.value=n.pending,n.pending=s,n.log&&y(n.log)}function y(n){var e=n.node1,t=n.nodes;if(null!==e&&E(e),null!==t)for(var l=0,u=t.length;l<u;l++)E(t[l])}function E(n){var e=a.time;n.age<e&&(n.age=e,n.state=i,a.updates.add(n),null!==n.owned&&b(n.owned),null!==n.log&&y(n.log))}function b(n){for(var e=0;e<n.length;e++){var t=n[e];t.age=a.time,t.state=r,null!==t.owned&&b(t.owned)}}function S(n){if(n.state===i){var e=h,t=d;h=d=n,n.state=c,k(n,!1),n.value=n.fn(n.value),n.state=r,h=e,d=t}}function k(n,e){var t,l,u=n.source1,o=n.sources,s=n.sourceslots,r=n.cleanups,i=n.owned;if(null!==r){for(t=0;t<r.length;t++)r[t](e);n.cleanups=null}if(null!==i){for(t=0;t<i.length;t++)j(i[t]);n.owned=null}if(null!==u&&(O(u,n.source1slot),n.source1=null),null!==o)for(t=0,l=o.length;t<l;t++)O(o.pop(),s.pop())}function O(n,e){var t,l,u=n.nodes,o=n.nodeslots;-1===e?n.node1=null:(t=u.pop(),l=o.pop(),e!==u.length&&(u[e]=t,o[e]=l,-1===l?t.source1slot=e:t.sourceslots[l]=e))}function j(n){n.fn=null,n.log=null,k(n,!0)}n.data();function x(){return app}var A,C,z=x();!function(n){var e=x();Object.assign(e.routes,n.routes)}({routes:{profile:(A=z.Surplus,C={go:z.go,model:z.model,vm:z.vm},function(){var n,e,t;return n=A.createElement("div",null,null),A.createElement("pre",null,n).textContent="The profile view",e=A.createElement("button",null,n),t=A.createElement("pre",null,n),A.S(function(){e.onclick=function(){C.go("home")},e.textContent="Back"}),A.S(function(n){return A.content(t,JSON.stringify(C,void 0,1),n)},""),n}())}})}();
